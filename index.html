<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YNS GALAXY - FINAL FIX</title>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=ATfsClCXiMMz7YyApME13i3yJkQK4UPDTL3PwPNh10Et5d17z9cpk-6_q0MqvCrVya9T5kwcc-OCY&currency=USD"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: white; }
        .glass { background: rgba(30, 30, 30, 0.9); border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); }
        .online-dot { width: 10px; height: 10px; background: #22c55e; border-radius: 50%; display: inline-block; margin-right: 5px; box-shadow: 0 0 8px #22c55e; }
    </style>
</head>
<body class="p-6">
    <h1 class="text-pink-600 font-black italic text-2xl mb-6">YNS GALAXY PRO</h1>
    <div id="user-list" class="grid grid-cols-2 gap-4"></div>
    <div class="mt-8 border-t border-white/10 pt-6">
        <h3 class="text-center text-sm mb-4 text-gray-400 font-bold">RECHARGE COINS</h3>
        <div id="paypal-button-container"></div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBwDUe5E8qRY1dbZzUQJu9eCAKBS7YSHVU",
            authDomain: "live-e6771.firebaseapp.com",
            projectId: "live-e6771",
            storageBucket: "live-e6771.firebasestorage.app",
            messagingSenderId: "570901004231",
            appId: "1:570901004231:web:220679cf41cf55b98023e2"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        auth.onAuthStateChanged(user => {
            if (user) {
                db.collection('profiles').doc(user.uid).set({ online: true }, { merge: true });
                window.onbeforeunload = () => db.collection('profiles').doc(user.uid).update({ online: false });
                loadUsers();
                renderPayPal();
            }
        });

        function loadUsers() {
            db.collection('profiles').onSnapshot(snap => {
                const list = document.getElementById('user-list');
                list.innerHTML = '';
                snap.forEach(doc => {
                    if(doc.id === auth.currentUser.uid) return;
                    const d = doc.data();
                    list.innerHTML += `
                        <div class="glass p-4 relative flex flex-col items-center">
                            <span class="${d.online ? 'online-dot' : ''}"></span>
                            <img src="${d.profilePic || 'https://i.pravatar.cc/100'}" class="w-16 h-16 rounded-full border-2 border-pink-600 mb-2">
                            <p class="text-xs font-bold">${d.name || 'User'}</p>
                            <button onclick="alert('Followed!')" class="mt-3 bg-pink-600 px-4 py-1 rounded-full text-[10px] font-bold">FOLLOW</button>
                        </div>`;
                });
            });
        }

        function renderPayPal() {
            document.getElementById('paypal-button-container').innerHTML = '';
            paypal.Buttons({
                createOrder: (data, actions) => actions.order.create({ purchase_units: [{ amount: { value: '5.00' } }] }),
                onApprove: (data, actions) => actions.order.capture().then(() => alert('Coins Added!'))
            }).render('#paypal-button-container');
        }
    </script>
</body>
</html>
