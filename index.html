<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YNS GALAXY PRO - Official</title>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://download.agora.io/sdk/release/AgoraRTC_N-4.18.2.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .active-tab { color: #ec4899; border-bottom: 2px solid #ec4899; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="bg-black text-white font-sans">

    <div class="fixed bottom-0 w-full glass z-50 flex justify-around p-4 border-t border-white/10">
        <button onclick="switchTab('home')" id="home-btn" class="active-tab text-xl"><i class="fas fa-home"></i></button>
        <button onclick="switchTab('live')" id="live-btn" class="text-gray-400 text-xl"><i class="fas fa-video"></i></button>
        <button onclick="switchTab('wallet')" id="wallet-btn" class="text-gray-400 text-xl"><i class="fas fa-wallet"></i></button>
        <button onclick="switchTab('profile')" id="profile-btn" class="text-gray-400 text-xl"><i class="fas fa-user"></i></button>
    </div>

    <div id="tab-home" class="p-5 pb-24">
        <h1 class="text-pink-500 italic font-black text-2xl mb-6">YNS GALAXY PRO</h1>
        <div class="grid grid-cols-2 gap-4">
            <div class="bg-zinc-900 p-4 rounded-3xl text-center">
                <img src="https://i.pravatar.cc/150?u=1" class="w-20 h-20 rounded-full mx-auto border-2 border-pink-500 mb-2">
                <p class="font-bold text-sm">User</p>
                <button class="bg-pink-600 px-4 py-1 rounded-full text-[10px] mt-2 font-bold uppercase">Follow</button>
            </div>
            <div class="bg-zinc-900 p-4 rounded-3xl text-center">
                <img src="https://i.pravatar.cc/150?u=2" class="w-20 h-20 rounded-full mx-auto border-2 border-pink-500 mb-2">
                <p class="font-bold text-sm">Nadisha</p>
                <button class="bg-pink-600 px-4 py-1 rounded-full text-[10px] mt-2 font-bold uppercase">Follow</button>
            </div>
        </div>
        <h2 class="text-gray-500 text-center font-bold text-xs mt-10 tracking-widest uppercase">Recharge Coins</h2>
    </div>

    <div id="tab-live" class="hidden h-screen bg-zinc-950 relative">
        <div id="local-video" class="w-full h-full bg-black"></div>
        <div class="absolute top-5 left-5 flex items-center gap-2">
            <div class="bg-black/50 p-1 px-3 rounded-full flex items-center gap-2">
                <span class="text-blue-400">üíé <span id="balance">30</span></span>
            </div>
        </div>
        <div class="absolute bottom-32 w-full text-center px-10">
            <button onclick="startSecureLive()" id="go-live-btn" class="bg-pink-600 w-full py-4 rounded-2xl font-black shadow-lg shadow-pink-500/20">GO LIVE NOW</button>
        </div>
        <button onclick="showGifts()" class="absolute bottom-32 right-5 w-14 h-14 bg-gradient-to-tr from-pink-500 to-yellow-500 rounded-full flex items-center justify-center shadow-xl"><i class="fas fa-gift text-xl"></i></button>
    </div>

    <div id="gift-panel" class="hidden fixed inset-0 bg-black/80 z-[60] flex items-end">
        <div class="w-full bg-zinc-900 rounded-t-[40px] p-8 grid grid-cols-3 gap-6">
            <div onclick="sendGift('üåπ', 10)" class="text-center bg-white/5 p-4 rounded-3xl">üåπ<p class="text-xs font-bold mt-1 text-gray-400">10</p></div>
            <div onclick="sendGift('üíé', 50)" class="text-center bg-white/5 p-4 rounded-3xl">üíé<p class="text-xs font-bold mt-1 text-gray-400">50</p></div>
            <div onclick="sendGift('ü¶Å', 500)" class="text-center bg-white/5 p-4 rounded-3xl">ü¶Å<p class="text-xs font-bold mt-1 text-gray-400">500</p></div>
            <button onclick="showGifts()" class="col-span-3 text-gray-500 text-xs font-bold">CLOSE</button>
        </div>
    </div>

    <script>
        // CONFIG - Verify this App ID with your Agora Console
        const AGORA_APP_ID = "d369ed90f2c04b599b9e680fbe3ca788"; 
        
        const client = AgoraRTC.createClient({ mode: "rtc", codec: "vp8" });
        let localTracks = [];

        function switchTab(tab) {
            document.querySelectorAll('[id^="tab-"]').forEach(el => el.classList.add('hidden'));
            document.getElementById('tab-' + tab).classList.remove('hidden');
            document.querySelectorAll('button[id$="-btn"]').forEach(el => el.classList.remove('active-tab'));
            document.getElementById(tab + '-btn').classList.add('active-tab');
        }

        async function startSecureLive() {
            const uid = Math.floor(Math.random() * 100000);
            try {
                // Backend ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä ‡∂Ü‡∂ª‡∂ö‡∑ä‡∑Ç‡∑í‡∂≠ Token ‡∂ë‡∂ö ‡∂â‡∂Ω‡∑ä‡∂Ω‡∂±‡∑Ä‡∑è
                const res = await fetch(`/api/generate-token?channelName=main_room&uid=${uid}`);
                const data = await res.json();

                if (!data.token) throw new Error("Key/Certificate missing in Vercel!");

                await client.join(AGORA_APP_ID, "main_room", data.token, uid);
                localTracks = await AgoraRTC.createMicrophoneAndCameraTracks();
                localTracks[1].play('local-video');
                await client.publish(localTracks);

                document.getElementById('go-live-btn').classList.add('hidden');
                alert("You are now LIVE and SECURE!");
            } catch (err) {
                alert("CAMERA ERROR: " + err.message + "\n\n1. Vercel ‡∂ë‡∂ö‡∂ß ‡∂ú‡∑í‡∑Ñ‡∑í‡∂±‡∑ä AGORA_APP_CERT variable ‡∂ë‡∂ö ‡∂Ø‡∑è‡∂Ω‡∑è Redeploy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.\n2. Browser Permission Allow ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.");
            }
        }

        function showGifts() { document.getElementById('gift-panel').classList.toggle('hidden'); }
        function sendGift(e, p) { alert(`Sending ${e}...`); showGifts(); }
    </script>
</body>
</html>
